{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["export const BASE_URL = \"https://pixabay.com/api/\";\nexport const API_KEY = \"48265594-3edacf02e8cadda91195713cc\";\n\nimport axios from 'axios';\n\nexport async function fetchPhotosByQuery(searchQuery, page = 1) {\n  const URL = `${BASE_URL}?key=${API_KEY}&q=${encodeURIComponent(searchQuery)}&image_type=photo&orientation=horizontal&safesearch=true&per_page=15&page=${page}`;\n  try{\n    const response = await axios.get(URL);\n    return response.data;\n  }catch(error){\nthrow new Error(\"Sorry, there are no imagies matching your search query. Please try again!\")\n  }\n}\n\n\n\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 200,\n});\n\n\nexport function galleryCard({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) {\n  return `\n    <div class=\"card\">\n      <div class=\"card-image\">\n        <a href=\"${largeImageURL}\" class=\"gallery-item-link\">\n          <img src=\"${webformatURL}\" alt=\"${tags}\" />\n        </a>\n      </div>\n      <div class=\"card-body\">\n      <p class=\"card-text\">\n        <span class=\"card-text-label\">Likes: </span>\n        <span class=\"card-text-value\">${likes}</span>\n      </p>\n      <p class=\"card-text\">\n        <span class=\"card-text-label\">Comments: </span>\n        <span class=\"card-text-value\">${comments}</span>\n      </p>\n      <p class=\"card-text\">\n        <span class=\"card-text-label\">Views: </span>\n        <span class=\"card-text-value\">${views}</span>\n      </p>\n      <p class=\"card-text\">\n        <span class=\"card-text-label\">Downloads: </span>\n        <span class=\"card-text-value\">${downloads}</span>\n      </p>\n    </div>\n    </div>`;\n}\n\nexport function renderImages(images, container, append = false) {\n    const imagesMarkup = images.map(galleryCard).join('');\n\n    if(append){\n      container.insertAdjacentHTML(\"beforeend\", imagesMarkup);\n    }else{\n      container.innerHTML = imagesMarkup;\n    }\n      \n    lightbox.refresh();  \n  }","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { fetchPhotosByQuery } from \"./js/pixabay-api.js\";\nimport { renderImages } from \"./js/render-functions.js\";\n\nlet page = 1; \nlet query = null; \nlet totalHits = 0; \n\nconst refs = {\n  form: document.querySelector(\".form\"),\n  gallery: document.querySelector(\".gallery\"),\n  loader: document.querySelector(\".loader\"),\n  loadButton: document.querySelector(\".load-button\"), \n};\n\nrefs.form.addEventListener(\"submit\", handlerEvent);\nrefs.loadButton.addEventListener(\"click\", handlerButton);\n\nasync function handlerEvent(event) {\n  event.preventDefault();\n\n  query = event.currentTarget.elements.query.value.trim();\n\n  if (query === \"\") {\n    iziToast.show({\n      title: 'Oops',\n      message: \"Sorry, there are no images matching your search query. Please try again!\",\n      color: \"#ef4040\",\n      position: \"bottomCenter\"\n    });\n    return;\n  }\n\n  page = 1;\n  refs.gallery.innerHTML = \"\";\n  refs.loadButton.classList.add(\"hidden\"); \n  showLoader();\n\n  try {\n    const data = await fetchPhotosByQuery(query, page);\n\n    if (data.hits.length === 0) {\n      iziToast.show({\n        title: 'No results',\n        message: \"Sorry, there are no images matching your search query. Please try again!\",\n        color: \"#ef4040\",\n        position: \"bottomCenter\"\n      });\n    } else {\n      totalHits = data.totalHits; \n      renderImages(data.hits, refs.gallery);\n\n      if (totalHits > page * 15) {\n        refs.loadButton.classList.remove(\"hidden\"); \n      }\n    }\n\n  } catch (error) { \n    iziToast.show({\n      title: 'Error',\n      message: \"Something went wrong. Please try again later.\",\n      color: \"#ef4040\",\n      position: \"bottomCenter\"\n    });\n  } finally {\n    hideLoader();\n    refs.form.reset(); \n  }\n}\n\nasync function handlerButton(event) {\n  page += 1; \n  showLoader();\n\n  try {\n    const data = await fetchPhotosByQuery(query, page);\n    \n    renderImages(data.hits, refs.gallery, true); \n\n    scrollCollection(); \n\n    if (totalHits <= page * 15) {\n      refs.loadButton.classList.add(\"hidden\");\n      iziToast.show({\n        title: 'Error',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        color: \"#ef4040\",\n        position: \"bottomCenter\"\n      });\n    }\n\n  } catch (error) {\n    iziToast.show({\n      title: 'Error',\n      message: \"Something went wrong. Please try again later.\",\n      color: \"#ef4040\",\n      position: \"bottomCenter\"\n    });\n  } finally {\n    hideLoader();\n  }\n}\n\nfunction showLoader() {\n    refs.loader.classList.remove(\"hidden\");\n}\n  \nfunction hideLoader() {\n    refs.loader.classList.add(\"hidden\");\n}\n\nfunction scrollCollection() {\n    const lastElementChild = refs.gallery.lastElementChild\n    const imageHeight = lastElementChild.getBoundingClientRect().height; \n    window.scrollBy({\n        top: imageHeight * 2,\n        left: 0,\n        behavior: \"smooth\" \n  });\n}\n\n  //1. Зробити синхронні ф-іі async-await \n  //2. Додати кнопку Load more\n  //3. Там де був використаний fetch , замінити бібл axios \n  //4. На кнопку Load more додати прослуховувча подій \n  //5. Зробити кнопу у стані enable коли у коллекціі ще є запити, та у стан disable коли більше немає запитів у коллекціі\n//  6.За один запит у відповідь приходить не більше 15 елементів\n  //7.Після додавання нових елементів до списку зображень на екземплярі SimpleLightbox викликається метод refresh()\n  //8. При кожному новому сабміті форми номер сторінки скидається до дефолтного 1 і результати попередніх запитів зникають"],"names":["BASE_URL","API_KEY","fetchPhotosByQuery","searchQuery","page","URL","axios","lightbox","SimpleLightbox","galleryCard","webformatURL","largeImageURL","tags","likes","views","comments","downloads","renderImages","images","container","append","imagesMarkup","query","totalHits","refs","handlerEvent","handlerButton","event","iziToast","showLoader","data","hideLoader","scrollCollection","imageHeight"],"mappings":"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"}