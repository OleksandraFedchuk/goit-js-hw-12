{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["export const BASE_URL = \"https://pixabay.com/api/\";\nexport const API_KEY = \"48265594-3edacf02e8cadda91195713cc\";\n\nimport axios from 'axios';\n\nexport async function fetchPhotosByQuery(searchQuery, page = 1) {\n  const URL = `${BASE_URL}?key=${API_KEY}&q=${encodeURIComponent(searchQuery)}&image_type=photo&orientation=horizontal&safesearch=true&per_page=15&page=${page}`;\n  try{\n    const response = await axios.get(URL);\n    return response.data;\n  }catch(error){\nthrow new Error(\"Sorry, there are no imagies matching your search query. Please try again!\")\n  }\n}\n  \n\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 200,\n});\n\n\nexport function galleryCard({webformatURL,largeImageURL,tags,likes,views,comments,downloads}){\n    return `<div class=\"card\">\n    <div class=\"card-apperance\">\n<a href=\"${largeImageURL}\" class=\"card-link\">\n<img src=\"${webformatURL}\" alt=\"${tags}\">\n</a>\n</div>\n<div class=\"card-discription\">\n<p class=\"discription\">Likes:${likes}</p>\n<p class=\"discription\">Views:${views}</p>\n<p class=\"discription\">Comments:${comments}</p>\n<p class=\"discription\">Downloads:${downloads}</p>\n</div>\n</div>`\n};\n\nexport function renderImages(images, container, append = false) {\n    const imagesMarkup = images.map(galleryCard).join('');\n\n    if(append){\n      container.insertAdjacentHTML(\"beforeend\", imagesMarkup);\n    }else{\n      container.innerHTML = imagesMarkup;\n    }\n      \n    lightbox.refresh();  \n  }","\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { fetchPhotosByQuery } from \"./js/pixabay-api.js\"\nimport { renderImages } from \"./js/render-functions.js\"\n\nlet page = 1 ; \nlet query = null; \nlet totalHits = 0;\n\nconst refs = {\n    button : document.querySelector('.btn'),\n    form: document.querySelector('.form'),\n    input: document.querySelector('.input'),\n    gallery: document.querySelector('.gallery'),\n    loader: document.querySelector(\".loader\"),\n    loadButton: document.querySelector(\".load-button\")\n}\n\nrefs.loadButton.addEventListener(\"click\", handlerButton);\nrefs.form.addEventListener(\"submit\", handlerEvent);\n\nasync function handlerEvent(event){\n    event.preventDefault();\n\n    const formQuery = event.currentTarget.elements.query.value.trim();\n\nif(formQuery === \"\"){\n    iziToast.show({\n        class: \"wave-stroke\",   \n        message: '🚫Sorry, there are no images matching your search query. Please try again!',\n        position: \"topRight\",\n        closeOnEscape: true,\n        closeOnClick: true,\n        backgroundColor: \"#e3545b\",\n});\nreturn;\n}\n\npage = 1;\nrefs.gallery.innerHTML = \"\";\nrefs.loadButton.classList.add(\"hidden\");\nshowLoader();\n\ntry{\n    const data = await fetchPhotosByQuery(query, page);\n\n    if(data.hits.length === 0){\n        iziToast.show({\n            title:'No results',\n            message:'Sorry, there are no images matching your search query. Please try again!',\n            color:'#e3545b',\n            position:\"topRight\"\n        });\n    }else{\n        totalHits = data.totalHits;\n        renderImages(data.hits, refs.gallery);\n\n        if(totalHits > page*15){\n            refs.loadButton.classList.remove(\"hidden\");\n        }\n    }\n}\ncatch(error) {\n    iziToast.show({\n        title:\"Error\",\n        message:\"Something went wrong. Please try again later.\",\n        color:'#e3545b',\n        position:\"topRight\"\n    });\n }finally{\n    hideLoader();\n    refs.form.reset();\n};\n}\n\nasync function handlerButton(event){\npage +=1;\nshowLoader();\n\ntry{\n    const data = await fetchPhotosByQuery(query, page);\n    renderImages(data.hits, refs.gallery, true);\n\n    scrollCollection();\n\n    if(totalHits <= page * 15){\n        refs.loadButton.classList.add(\"hidden\");\n        iziToast.show({\n            title:\"Error\",\n            message:\"We're sorry, but you've reached the end of search results.\",\n            color: '#ef4040',\n            position:\"bottomCenter\"\n        });\n    }\n}catch(error){\niziToast.show({\n    title:\"Error\",\n    message: \"Something went wrong. Please try again later.\",\n    color: \"#ef4040\",\n    position:\"bottomCenter\"\n})\n}finally{\n    hideLoader();\n}}\n\n\nfunction showLoader() {\n    refs.loader.classList.remove(\"hidden\");\n  }\n  \n  function hideLoader() {\n    refs.loader.classList.add(\"hidden\");\n  }\n\n  function scrollCollection(){\n    const lastElementChild = refs.gallery.lastElementChild;\n    const imageHeight = lastElementChild.getBoundingClientRect().height;\n    window.scrollBy({\n        top: imageHeight * 2,\n        left: 0,\n        behavior: \"smooth\"\n    });\n  }\n\n  //1. Зробити синхронні ф-іі async-await \n  //2. Додати кнопку Load more\n  //3. Там де був використаний fetch , замінити бібл axios \n  //4. На кнопку Load more додати прослуховувча подій \n  //5. Зробити кнопу у стані enable коли у коллекціі ще є запити, та у стан disable коли більше немає запитів у коллекціі\n//  6.За один запит у відповідь приходить не більше 15 елементів\n  //7.Після додавання нових елементів до списку зображень на екземплярі SimpleLightbox викликається метод refresh()\n  //8. При кожному новому сабміті форми номер сторінки скидається до дефолтного 1 і результати попередніх запитів зникають"],"names":["BASE_URL","API_KEY","fetchPhotosByQuery","searchQuery","page","URL","axios","lightbox","SimpleLightbox","galleryCard","webformatURL","largeImageURL","tags","likes","views","comments","downloads","renderImages","images","container","append","imagesMarkup","query","totalHits","refs","handlerButton","handlerEvent","event","iziToast","showLoader","data","hideLoader","scrollCollection","imageHeight"],"mappings":"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"}